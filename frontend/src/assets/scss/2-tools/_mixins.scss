/*------------------------------------*\
	MIXINS
\*------------------------------------*/

@mixin animation($value) {
    -webkit-animation: $value;
    -moz-animation: $value;
    animation: $value;
}

@mixin box-shadow($top, $left, $blur, $color, $spread: false, $inset: false) {
    @if $inset {
        @if $spread {
            -webkit-box-shadow: inset $top $left $blur $color;
            -moz-box-shadow: inset $top $left $blur $color;
            box-shadow: inset $top $left $blur $color;
        } @else {
            -webkit-box-shadow: inset $top $left $blur $color;
            -moz-box-shadow: inset $top $left $blur $color;
            box-shadow: inset $top $left $blur $color;
        }
    } @else {
        @if $spread {
            -webkit-box-shadow: $top $left $blur $spread $color;
            -moz-box-shadow: $top $left $blur $spread $color;
            box-shadow: $top $left $blur $spread $color;
        } @else {
            -webkit-box-shadow: $top $left $blur $color;
            -moz-box-shadow: $top $left $blur $color;
            box-shadow: $top $left $blur $color;
        }
    }
}

/**
 * Cut off text and truncate with ...
 * display must be block or inline-block
 * for this to work.
 */
@mixin ellipsis($display: inline-block) {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    max-width: 100%;
    display: $display;
}

@mixin fill-viewport-height() {
    height: 100%;
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
}

@mixin fixedViewHeightScrollY {
    height: 100vh;
    height: calc(var(--vh, 1vh) * 100);
    overflow-y: auto;
}

@mixin icon-fill($color) {
    // Targets .c-icon
    path {
        fill: $color;
    }
    // Targets parent of .c-icon
    svg {
        path {
            fill: $color;
        }
    }
}

// See _colors.scss -> "bookmark" as an example of the expected structure for leveraging custom color maps
@mixin get-color-classes-from-map(
    $property,
    $type: "bookmark",
    $value: "primary"
) {
    @each $colorKey, $colorMap in map-deep-get($colors, $type, "values") {
        &.-#{$type}-color-#{$colorKey} {
            #{$property}: map-get($colorMap, $value);
        }
    }
}

/**
 * Surround the content in an Internet Explorer-specific media query
 * so that these styles only apply to Internet Explorer.
 */
@mixin if-internet-explorer() {
    @media screen and (-ms-high-contrast: active), (-ms-high-contrast: none) {
        @content;
    }
}

/**
 * Surround the content in an Firefox-specific media query
 * so that these styles only apply to Firefox.
 */
@mixin if-firefox() {
    @-moz-document url-prefix() {
        @content;
    }
}

/**
 * set object-fit with a workaround for IE.
 */
@mixin object-fit-cover {
    object-fit: cover;
    width: 100%;
    height: 100%;
}

@mixin keyframes($name) {
    @-webkit-keyframes #{$name} {
        @content;
    }

    @-moz-keyframes #{$name} {
        @content;
    }

    @-ms-keyframes #{$name} {
        @content;
    }

    @keyframes #{$name} {
        @content;
    }
}

@mixin transform($value) {
    -webkit-transform: $value;
    -moz-transform: $value;
    transform: $value;
}

// Font Mixins
// -------------------------------

@mixin font-style(
    $family: $font-primary,
    $size: "base",
    $color: false,
    $weight: "base",
    $line-height: false,
    $style: false // italic, etc.
) {
    @include font-size($size);
    font-family: $family;

    @if type_of($weight) == string {
        font-weight: get-font-weight($weight);
    } @else {
        font-weight: $weight;
    }

    @if $color {
        color: $color;
    }

    @if $line-height {
        @if type_of($line-height) == string {
            line-height: get-line-height($line-height);
        } @else {
            line-height: $line-height;
        }
    }

    @if $style {
        font-style: $style;
    }
}

@mixin font-size($size: "base") {
    @include rem-fallback(font-size, get-font-size($size));
}

@mixin line-height($size: "base") {
    line-height: get-line-height($size);
}

// Responsive Styles
// --------------------------

@mixin non-retina {
    @media not screen and (-webkit-min-device-pixel-ratio: 2),
        not screen and (min--moz-device-pixel-ratio: 2),
        not screen and (-o-min-device-pixel-ratio: 2/1),
        not screen and (min-device-pixel-ratio: 2),
        not screen and (min-resolution: 192dpi),
        not screen and (min-resolution: 2dppx) {
        @content;
    }
}

@mixin respond-to($media) {
    @if map-has-key($breakpoints, $media) {
        @media (max-width: map-get($breakpoints, $media)) {
            @content;
        }
    } @else if $media == non-retina {
        @media screen and (-webkit-max-device-pixel-ratio: 1) {
            @content;
        }
    } @else if $media == retina {
        @include retina();
    } @else {
        @media only screen and (max-width: #{$media}px) {
            @content;
        }
    }
}

// For use on mobile first stylesheets
@mixin respond-to-min-width($media) {
    @if map-has-key($breakpoints, $media) {
        @media (min-width: map-get($breakpoints, $media)) {
            @content;
        }
    } @else if $media == non-retina {
        @media screen and (-webkit-max-device-pixel-ratio: 1) {
            @content;
        }
    } @else if $media == retina {
        @include retina();
    } @else {
        @media only screen and (min-width: #{$media}px) {
            @content;
        }
    }
}

@mixin retina {
    @media only screen and (-webkit-min-device-pixel-ratio: 2),
        only screen and (min--moz-device-pixel-ratio: 2),
        only screen and (-o-min-device-pixel-ratio: 2/1),
        only screen and (min-device-pixel-ratio: 2),
        only screen and (min-resolution: 192dpi),
        only screen and (min-resolution: 2dppx) {
        @content;
    }
}

@mixin clearfix {
    &:before,
    &:after {
        content: " ";
        display: table;
    }

    &:after {
        display: block;
        clear: both;
        height: 1px;
        margin-top: -1px;
        visibility: hidden;
    }

    & {
        *zoom: 1;
    }
}

@mixin clearlist {
    list-style-type: none;
    margin: 0;
    padding: 0;
}

// REM Mixins
// -------------------------------

@mixin rem-fallback($property, $values...) {
    $max: length($values);
    $pxValues: "";
    $remValues: "";

    @for $i from 1 through $max {
        $value: strip-unit(nth($values, $i));
        $pxValues: #{$pxValues + $value}px;

        @if $i < $max {
            $pxValues: #{$pxValues + " "};
        }
    }

    @for $i from 1 through $max {
        $value: strip-unit(nth($values, $i));
        $remValues: #{$remValues + (rem($value))};

        @if $i < $max {
            $remValues: #{$remValues + " "};
        }
    }

    #{$property}: $pxValues;
    #{$property}: $remValues;
}

// Box Model
// -------------------------------

@mixin margin($values...) {
    @include rem-fallback(margin, $values...);
}

@mixin margin-bottom($value) {
    @include rem-fallback(margin-bottom, $value);
}

@mixin margin-left($value) {
    @include rem-fallback(margin-left, $value);
}

@mixin margin-right($value) {
    @include rem-fallback(margin-right, $value);
}

@mixin margin-top($value) {
    @include rem-fallback(margin-top, $value);
}

@mixin padding($values...) {
    @include rem-fallback(padding, $values...);
}

@mixin padding-bottom($value) {
    @include rem-fallback(padding-bottom, $value);
}

@mixin padding-left($value) {
    @include rem-fallback(padding-left, $value);
}

@mixin padding-right($value) {
    @include rem-fallback(padding-right, $value);
}

@mixin padding-top($value) {
    @include rem-fallback(padding-top, $value);
}

// Borders
// -------------------------------

@mixin border-top($size, $style: solid, $color: get-color-primary("black")) {
    border-top: $size $style $color;
}

@mixin border-right($size, $style: solid, $color: get-color-primary("black")) {
    border-right: $size $style $color;
}

@mixin border-bottom($size, $style: solid, $color: get-color-primary("black")) {
    border-bottom: $size $style $color;
}

@mixin border-left($size, $style: solid, $color: get-color-primary("black")) {
    border-left: $size $style $color;
}

@mixin border(
    $topSize,
    $rightSize,
    $bottomSize,
    $leftSize,
    $style: solid,
    $color: get-color-primary("black")
) {
    @include border-top($topSize, $style, $color);
    @include border-right($rightSize, $style, $color);
    @include border-bottom($bottomSize, $style, $color);
    @include border-left($leftSize, $style, $color);
}

@mixin border-radius($size: "base") {
    @if ($size == "large") {
        border-radius: $border-radius-medium;
    }
    @if ($size == "base") {
        border-radius: $border-radius-small;
    }
}

// Inputs
// -------------------------------

@mixin placeholder {
    &::-webkit-input-placeholder {
        @content;
    }
    &:-moz-placeholder {
        @content;
    }
    &::-moz-placeholder {
        @content;
    }
    &:-ms-input-placeholder {
        @content;
    }
    &::placeholder {
        @content;
    }
}
